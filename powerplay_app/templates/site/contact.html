{% extends "site/base.html" %}
{% load static %}

{% block title %}Kontakt | {% if primary_team %}{{ primary_team.name }} | {% endif %}PowerPlay{% endblock %}
{% block crumbs %}Dom≈Ø / Kontakt{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'site/css/contact.css' %}">
{% endblock %}

{% block content %}
<section class="section">
  <div class="container">
    <h1 class="section__title">Kontakt</h1>

    {# ========== 1) KONTAKTN√ç OSOBY (naho≈ôe) ========== #}
    <div class="card mt-2">
      <h2 class="card__title">Kontaktn√≠ osoby</h2>
      {% if staff %}
        <div class="contact-list mt-2">
          {% for m in staff %}
            <div class="contact-row" aria-label="Kontakt: {{ m.first_name }} {{ m.last_name }}">
              <div class="c-name">
                <a href="{% url 'site:staff_detail' pk=m.pk %}" class="link-strong">{{ m.first_name }} {{ m.last_name }}</a>
                {% if m.role %}<span class="c-role">{{ m.role }}</span>{% endif %}
              </div>
              <div class="c-contact">
                {% if m.email %}
                  <a class="link" href="mailto:{{ m.email }}">{{ m.email }}</a>
                {% else %}
                  <span class="muted">‚Äî</span>
                {% endif %}
                {% if m.phone %}
                  <span class="dot" aria-hidden="true"></span>
                  <a class="link" href="tel:{{ m.phone|cut:" " }}">{{ m.phone }}</a>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="muted">Zat√≠m bez kontaktn√≠ch osob.</p>
      {% endif %}
    </div>

    {# ========== 2) KLUBOV√â KONTAKTY (prost≈ôedn√≠ box) ========== #}
    <div class="card mt-2">
      <h2 class="card__title">Klubov√© kontakty</h2>
      <div class="contact-actions mt-2">
        {% if team and team.public_email %}
          <a class="filter__link" href="mailto:{{ team.public_email }}">‚úâÔ∏è {{ team.public_email }}</a>
        {% endif %}
        {% if team and team.website_url %}
          <a class="filter__link" href="{{ team.website_url }}" target="_blank" rel="noopener">üåê Web klubu</a>
        {% endif %}

        {% if team %}
          {% if not team.public_email and not team.website_url %}
            <p class="muted">‚Äî Zat√≠m bez ve≈ôejn√Ωch kontakt≈Ø ‚Äî</p>
          {% endif %}
        {% else %}
          <p class="muted">‚Äî Zat√≠m bez ve≈ôejn√Ωch kontakt≈Ø ‚Äî</p>
        {% endif %}
      </div>
    </div>

    {# ========== 3) STADION & M√çSTO (spodn√≠ box) ========== #}
    <div class="card mt-2 stadium">
      <h2 class="card__title">Stadion &amp; m√≠sto</h2>

      {# INFO NAHO≈òE ‚Äì v jednom ≈ô√°dku: Stadion | Adresa | Mƒõsto #}
      <div class="info-top">
        <div class="info-top__item">
          <span class="info-top__k">Stadion</span>
          <span class="info-top__v">
            {% if team and team.stadium %}{{ team.stadium.name }}{% else %}‚Äî{% endif %}
          </span>
        </div>
        <div class="info-top__item">
          <span class="info-top__k">Adresa</span>
          <span class="info-top__v">
            {% if team and team.stadium and team.stadium.address %}{{ team.stadium.address }}{% else %}‚Äî{% endif %}
          </span>
        </div>
        <div class="info-top__item">
          <span class="info-top__k">Mƒõsto</span>
          <span class="info-top__v">
            {% if team and team.city %}{{ team.city }}{% else %}‚Äî{% endif %}
          </span>
        </div>
      </div>

      {# FOTO ‚Äî vlevo dole (pokud je) #}
      {% if team and team.stadium and team.stadium.photo %}
        <img
          class="stadium__photo"
          src="{{ team.stadium.photo.url }}"
          alt="{{ team.stadium.name }}"
          loading="lazy" decoding="async">
      {% endif %}

      {# MAPA (embed) ‚Äî vpravo dole (pokud je) #}
      {% if team and team.stadium and team.stadium.embed_url %}
        <iframe
          class="stadium__map"
          src="{{ team.stadium.embed_url }}"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          allowfullscreen></iframe>
      {% endif %}

      {# FALLBACK ‚Äì kdy≈æ nen√≠ t√Ωm/stadion, nebo chyb√≠ obƒõ m√©dia #}
      {% if not team or not team.stadium %}
        <img class="stadium__photo"
             src="{% static 'powerplay_app/img/default_player.png' %}"
             alt="Stadion" loading="lazy" decoding="async">
      {% elif not team.stadium.photo and not team.stadium.embed_url %}
        <img class="stadium__photo"
             src="{% static 'powerplay_app/img/default_player.png' %}"
             alt="{{ team.stadium.name }}" loading="lazy" decoding="async">
      {% endif %}

      {# TLAƒå√çTKO ‚Äì pod mapou vpravo #}
      {% if team and team.stadium %}
        {% if team.stadium.map_url %}
          <p class="stadium__open">
            <a class="btn" href="{{ team.stadium.map_url }}" target="_blank" rel="noopener">Otev≈ô√≠t mapu</a>
          </p>
        {% elif team.stadium.address %}
          <p class="stadium__open">
            <a class="btn"
               href="https://www.google.com/maps?q={{ team.stadium.address|urlencode }}"
               target="_blank" rel="noopener">Otev≈ô√≠t mapu</a>
          </p>
        {% endif %}
      {% endif %}
    </div>

  </div>
</section>
{% endblock %}
